# LockBit

## Scenario:

A medium-sized corporation has experienced a ransomware attack, first identified when a user reported a ransom note on their screen alongside a Windows Defender alert indicating malicious activity. Your task is to analyze logs provided from the compromised machines and identify the ransomware's entry point.

## Walkthrough & Writeup

![2024-09-17_21-13](https://github.com/user-attachments/assets/6df25bd1-bdd5-4a60-a201-925ff9da4788)

Starting with the Domain Controller (DC01), I look at the Defender logs to see if it has flagged anything on the system.

A suspicious executable file in the ADMIN$ share on the Domain Controller? Not looking good...

![2024-09-17_21-18](https://github.com/user-attachments/assets/17ffac01-6d8e-4dfc-b90a-bba760a7e361)

MPlogs are "Microsoft Protection" logs, and are generated by Defender or MS Security Essentials. If Defender has flagged anything on the system, they are a good place to look to gain a brief overview of the situation.

As we can see, the CobaltStrike executable is adding a file path to the exclusions list. What this exclusion is telling Defender to do is to skip over the entire specified file path when scanning the system for malicious activity. 

![2024-09-17_21-40](https://github.com/user-attachments/assets/a144fe9e-ed2e-4f39-813d-bb7762a2c866) 
-----------------------------
![2024-09-17_21-41](https://github.com/user-attachments/assets/ca68fad1-0fb0-4b47-8e87-c6e273d22f15)

Comparing these two event logs, we can see two internal IP's -the DC, and one other- communicating over high port numbers right before the malicious software was installed.
